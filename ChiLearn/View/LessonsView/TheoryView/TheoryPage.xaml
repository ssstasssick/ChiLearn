<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:swipe="clr-namespace:Microsoft.Maui.Controls;assembly=Microsoft.Maui.Controls"
             x:Class="ChiLearn.View.LessonsView.TheoryView.TheoryPage"
             xmlns:behaviors="clr-namespace:ChiLearn.Behaviors"
             Title="Ð¢ÐµÐ¾Ñ€Ð¸Ñ">
    <Grid RowDefinitions="Auto, *, Auto">

        <!-- ÐŸÑ€Ð¾Ð³Ñ€ÐµÑÑ-Ð±Ð°Ñ€ -->
        <ProgressBar Grid.Row="0"
             Progress="{Binding ProgressPercentage}"
             Margin="20,10"
             HeightRequest="10">
            <ProgressBar.ProgressColor>
                <Binding Path="ProgressPercentage" 
                     
                 Converter="{StaticResource ProgressColorConverter}"/>
            </ProgressBar.ProgressColor>
        </ProgressBar>

        <CarouselView x:Name="carousel"
                      
                      Grid.Row="1"
                      ItemsSource="{Binding Words}"
                      Position="{Binding CurrentPosition, Mode=Default}"
                      Loop="False"
                      PeekAreaInsets="0"
                      VerticalOptions="FillAndExpand">
            
            
            <CarouselView.ItemTemplate>
                <DataTemplate>

                    <Grid Padding="20">

                        <!-- ÐšÐ°Ñ€Ñ‚Ð¾Ñ‡ÐºÐ° ÑÐ»Ð¾Ð²Ð° -->
                        <Frame CornerRadius="20"                                
                               Padding="30"
                               VerticalOptions="Center"
                               HorizontalOptions="Center"
                               WidthRequest="300"
                               HeightRequest="500">

                            <StackLayout Spacing="20">
                                <!-- ÐšÐ¸Ñ‚Ð°Ð¹ÑÐºÐ¾Ðµ ÑÐ»Ð¾Ð²Ð¾ -->
                                <Label Text="{Binding ChiWord}" 
                                       FontSize="100"
                                       HorizontalOptions="Center"
                                       FontAttributes="Bold"/>

                                <!-- ÐŸÐ¸Ð½ÑŒÐ¸Ð½ÑŒ -->
                                <Label Text="{Binding Pinyin}"
                                       FontSize="24"
                                       HorizontalOptions="Center"
                                       TextColor="Gray"/>

                                <!-- ÐŸÐµÑ€ÐµÐ²Ð¾Ð´Ñ‹ -->
                                <BoxView HeightRequest="2" Color="LightGray"/>

                                <Label Text="{Binding RuWord}"
                                       FontSize="24"
                                       HorizontalOptions="Center"/>

                                <!--<Label Text="{Binding EngWord}"
                                       FontSize="20"
                                       HorizontalOptions="Center"
                                       TextColor="Gray"/>-->

                                <Button Text="ðŸ”Š"
                                        FontSize="50"
                                        Command="{Binding BindingContext.PlayAudioCommand, Source={x:Reference carousel}}"
                                        CommandParameter="{Binding}"
                                        HorizontalOptions="Center"
                                        CornerRadius="100"
                                        Margin="10"
                                        Padding="20,20"/>
                            </StackLayout>

                        </Frame>
                    </Grid>
                </DataTemplate>
            </CarouselView.ItemTemplate>
        </CarouselView>

        <!-- ÐšÐ½Ð¾Ð¿ÐºÐ° Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ (Ð²Ð¸Ð´Ð½Ð° Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¿Ð¾ÑÐ»Ðµ Ð¿Ñ€Ð¾Ñ…Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ) -->
        <Button Grid.Row="2"
                Text="Ð—Ð°Ð²ÐµÑ€ÑˆÐ¸Ñ‚ÑŒ ÑƒÑ€Ð¾Ðº"
                IsVisible="{Binding AllWordsViewed}"
                Command="{Binding FinishLessonCommand}"
                VerticalOptions="End"
                Margin="20"
                CornerRadius="20"/>     
    </Grid>

</ContentPage>